# MouseBaby

> **龙生龙，凤生凤，老鼠的孩子会打洞 —— 中国俗语**

MouseBaby 是一个基于 **P2P 网络** 的 **UDP 端口映射工具**，旨在实现 **NAT 穿透** 和 **远程 UDP 端口转发** 功能。

---

## 项目概述

MouseBaby 提供了一种基于 P2P 网络的远端 UDP 端口映射解决方案，通过建立隧道实现两个位于不同 NAT 后的设备之间的直接通信。

项目主要包含三个核心模块：

- **STUN 客户端**：用于获取设备的公网 IP 和端口信息
- **信令服务器**：使用百度云作为中介交换两端的网络信息
- **数据隧道**：建立两端之间的直接数据传输通道

---

## 工作原理

### 端口映射机制

- **客户端模式**  
  在本地监听 UDP 端口，接收应用程序数据并转发到 P2P 隧道端点

- **服务端模式**  
  接收来自隧道的数据并转发到目标 UDP 服务端口

通过这种方式，MouseBaby 实现了 **跨越 NAT 的远程 UDP 端口映射** 功能。

---

## 核心功能

### UDP 代理功能
- 支持 UDP 数据包的双向转发
- 自动管理客户端连接和会话
- 实现连接状态的心跳检测机制
- 支持动态客户端 ID 分配和管理

### 连接管理
- 自动清理超时连接（30 秒无活动）
- 客户端连接状态跟踪
- 支持 CONNECT/DISCONNECT 协议握手

### 多线程处理
- 使用线程池处理并发任务
- 非阻塞 I/O 多路复用处理 UDP 数据
- 后台清理线程维护连接状态

---

## 配置和使用

### 配置文件

项目使用 **YAML** 格式的配置文件，例如：

客户端:

```yaml
mode: client
id: A
peer: B
port: 27000
```

服务端:

```yaml
mode: server
id: B
peer: A
port: 1194
```

### 配置参数说明
```
mode: 运行模式，可选 client 或 server

id: 本端标识符

peer: 对端标识符

port: 端口号（客户端为监听端口，服务端为转发目标端口）
```

### 使用
配置好配置文件后 两端同时执行python cli.py等着打洞成功就行
